Select a.date_funded, b."YLI_Total_Fundings", c."YLII_Total_Fundings", d."YLIII_Total_Fundings",e."YLIV_Total_Fundings",f."YL_V_Total_Fundings",
g."YL_KS_Total_Fundings",h."LF_Total_Fundings",i."Allianz_Total_Fundings", j."Shopify_Total_Fundings",k."Rogge_Investors_Total_Fundings",l."Shire_Securities_Total_Fundings",m."YL_Gmbh_Total_Fundings"

from 
(
Select date_trunc('month', "Loans"."DateFunded") AS date_funded
From domain."Loans"
group by 1
)a 

Left Join
 
 (Select b1.date_funded, sum(b1."FundedAmount") as "YLI_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'YL I Limited'


 
 )b1
 group by 1
)b
 
 on a.date_funded = b.date_funded
 
Left Join
 
 (Select c1.date_funded, sum(c1."FundedAmount") as "YLII_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'YL II Limited'
 
 )c1
 group by 1
)c 
 
 on a.date_funded = c.date_funded
 
 Left Join
 
 (Select d1.date_funded, sum(d1."FundedAmount") as "YLIII_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'YL III Limited'
 
 )d1
 group by 1
)d
 
 on a.date_funded = d.date_funded
 
 Left Join
 
 (Select e1.date_funded, sum(e1."FundedAmount") as "YLIV_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'YL IV Limited'
 
 )e1
 group by 1
)e 
 
 on a.date_funded = e.date_funded
 
 Left Join
 
 (Select f1.date_funded, sum(f1."FundedAmount") as "YL_V_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'YL V Limited'
 
 )f1
 group by 1
)f
 
 on a.date_funded = f.date_funded
 
 Left Join
 
 (Select g1.date_funded, sum(g1."FundedAmount") as "YL_KS_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'Youlend I K/S Limited'
 
 )g1
 group by 1
)g 
 
 on a.date_funded = g.date_funded
 
 Left Join
 
 (Select h1.date_funded, sum(h1."FundedAmount") as "LF_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'Liquid Finance Receivables Limited'
 
 )h1
 group by 1
)h 
 
 on a.date_funded = h.date_funded
 
 Left Join
 
 (Select i1.date_funded, sum(i1."FundedAmount") as "Allianz_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'Allianz Trade Finance Funds S.A. SICAV-RAIF'
 
 )i1
 group by 1
)i 
 
 on a.date_funded = i.date_funded
 
 Left Join
 
 (Select j1.date_funded, sum(j1."FundedAmount") as "Shopify_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'Shopify International Limited'
 
 )j1
 group by 1
)j
 
 on a.date_funded = j.date_funded
 
 Left Join
 
 (Select k1.date_funded, sum(k1."FundedAmount") as "Rogge_Investors_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'Rogge Investors'
 
 )k1
 group by 1
)k 
 
 on a.date_funded = k.date_funded
 
 Left Join
 
 (Select l1.date_funded, sum(l1."FundedAmount") as "Shire_Securities_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'Shire Securities Ltd'
 
 )l1
 group by 1
)l
 
 on a.date_funded = l.date_funded
 
 Left Join
 
 (Select m1.date_funded, sum(m1."FundedAmount") as "YL_Gmbh_Total_Fundings"
 from
 (
 Select date_trunc('month', domain."Loans"."DateFunded") AS date_funded, domain."Loans"."FundedAmount"
 From domain."Loans"
 Left Join "domain"."Lenders" on domain."Loans"."LenderId"= "domain"."Lenders"."LenderId"
 Left Join "domain"."Parties"  on "domain"."Lenders"."PartyId" = "domain"."Parties"."PartyId"
 
where "domain"."Parties"."PartyName" = 'YouLend GmbH'
 
 )m1
 group by 1
)m
 
 on a.date_funded = m.date_funded
 
order by 1

